<!doctype html>
<html lang="th">
<head>
  <meta property="og:image" content="https://USERNAME.github.io/REPO/cover.png">
  <meta property="og:title" content="‡∏Å‡∏£‡∏≠‡∏Å BMI ‡∏Ç‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏≤">
  <meta property="og:description" content="‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î ‚Äò‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì & ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‚Äô ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡πÜ ‡∏ó‡∏µ‡πà‡∏ô‡πà‡∏≤‡∏£‡∏±‡∏Å‡∏ô‡∏∞‡∏Ñ‡∏∞ üíô">
  

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏° BMI ‡∏Ç‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏≤</title>
  <meta name="description" content="‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡πÜ ‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏£‡∏¥‡∏á ‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô ‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å ‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏π‡∏á ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î ‚Äò‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì & ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‚Äô ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢ ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡πÜ ‡∏ó‡∏µ‡πà‡∏ô‡πà‡∏≤‡∏£‡∏±‡∏Å‡∏ô‡∏∞‡∏Ñ‡∏∞ üíô">
  <meta name="theme-color" content="#2563eb">

  <!-- Open Graph / Social Preview -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="‡∏Å‡∏£‡∏≠‡∏Å BMI ‡∏Ç‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏≤">
  <meta property="og:description" content="‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î ‚Äò‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì & ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‚Äô ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡πÜ ‡∏ó‡∏µ‡πà‡∏ô‡πà‡∏≤‡∏£‡∏±‡∏Å‡∏ô‡∏∞‡∏Ñ‡∏∞ üíô">
  <meta property="og:url" content="https://YOURDOMAIN/bmi.html">
  <meta property="og:image" content="https://YOURDOMAIN/cover-bmi-1200x630.png">
  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="‡∏Å‡∏£‡∏≠‡∏Å BMI ‡∏Ç‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏≤">
  <meta name="twitter:description" content="‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î ‚Äò‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì & ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‚Äô ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢">
  <meta name="twitter:image" content="https://YOURDOMAIN/cover-bmi-1200x630.png">

  <style>
    :root{
      --bg:#f6f7fb; --card:#fff; --ink:#0f172a; --muted:#64748b;
      --link:#2563eb; --ring:#93c5fd; --danger:#ef4444;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,"Noto Sans Thai",sans-serif;background:var(--bg);color:var(--ink)}
    .container{max-width:1100px;margin:auto;padding:20px}
    .card{background:var(--card);border-radius:14px;box-shadow:0 8px 24px rgba(2,6,23,.08);padding:16px;margin-bottom:16px}
    h1{margin:0 0 8px;font-size:1.35rem}
    h2{margin:0 0 10px;font-size:1.05rem}
    p.lead{margin:0;color:var(--muted)}
    /* Tabs */
    .tabs{display:flex;gap:8px;margin-bottom:12px}
    .tabbtn{border:1px solid #e5e7eb;background:#f8fafc;border-radius:10px;padding:9px 12px;font-weight:600;cursor:pointer}
    .tabbtn.active{background:var(--link);color:#fff;border-color:transparent}
    /* Notice */
    .notice{display:flex;gap:12px;align-items:flex-start;background:#eef2ff;border:1px solid #dbeafe;border-radius:12px;padding:12px}
    .notice b{display:block}
    /* Form layout */
    .grid{display:grid;gap:12px}
    .grid-4{grid-template-columns:repeat(4,1fr)}
    @media (max-width:900px){ .grid-4{grid-template-columns:repeat(2,1fr)} }
    @media (max-width:600px){ .grid-4{grid-template-columns:1fr} }
    label{font-size:.9rem;margin:4px 0;display:block}
    .field{background:#fafafa;border:1px solid #e5e7eb;border-radius:10px;padding:10px 12px;width:100%;outline:none}
    .field:focus{border-color:var(--ring);box-shadow:0 0 0 4px rgba(147,197,253,.35)}
    .actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}
    button{border:0;border-radius:10px;padding:10px 14px;font-weight:700;cursor:pointer}
    .primary{background:var(--link);color:#fff}
    .ghost{background:#f1f5f9}
    .danger{background:#fee2e2;color:#991b1b}
    /* Tables */
    .table-wrap{overflow:auto}
    table{width:100%;border-collapse:collapse}
    th,td{padding:10px;border-bottom:1px solid #eef2f7;text-align:left;white-space:nowrap}
    th{background:#f8fafc}
    .status{padding:2px 8px;border-radius:999px;font-size:.85rem;font-weight:700}
    .low{background:#e0f2fe;color:#075985}
    .ok{background:#dcfce7;color:#166534}
    .over{background:#fef3c7;color:#92400e}
    .ob1{background:#fde68a;color:#92400e}
    .ob2{background:#fee2e2;color:#991b1b}
    .tag{display:inline-block;padding:2px 8px;border-radius:999px;background:#eef2ff}
    .oktag{background:#dcfce7;color:#166534}
    .waittag{background:#fff7ed;color:#92400e}
    .instant{margin-top:10px}
  </style>
</head>
<body>
  <div class="container">
    <div class="tabs">
      <button class="tabbtn active" data-tab="formTab">‡∏´‡∏ô‡πâ‡∏≤ 1: ‡∏Å‡∏£‡∏≠‡∏Å BMI</button>
      <button class="tabbtn" data-tab="statusTab">‡∏´‡∏ô‡πâ‡∏≤ 2: ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á</button>
    </div>

    <!-- TAB 1: ‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Å‡∏£‡∏≠‡∏Å -->
    <section id="formTab" class="card">
      <h1>‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡πà‡∏≤ BMI</h1>
      <div class="notice" role="note" aria-label="‡∏Ñ‡∏≥‡πÄ‡∏ä‡∏¥‡∏ç‡∏ä‡∏ß‡∏ô">
        <div>üì£</div>
        <div>
          <b>‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡πÜ ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î ‚Äú‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì & ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‚Äù ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢</b>
          <span class="lead">‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡πÜ ‡∏ó‡∏µ‡πà‡∏ô‡πà‡∏≤‡∏£‡∏±‡∏Å‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏ä‡πà‡∏ß‡∏¢‡∏Å‡∏£‡∏≠‡∏Å‡∏ô‡∏∞‡∏Ñ‡∏∞ üíô</span>
        </div>
      </div>
      <p class="lead" style="margin-top:8px">‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡πÄ‡∏≠‡πÄ‡∏ä‡∏µ‡∏¢/‡πÑ‡∏ó‡∏¢: ‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏Å‡∏ì‡∏ë‡πå &lt;18.5, ‡∏õ‡∏Å‡∏ï‡∏¥ 18.5‚Äì22.9, ‡∏ó‡πâ‡∏ß‡∏° 23.0‚Äì24.9, ‡∏≠‡πâ‡∏ß‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö 1 (25.0‚Äì29.9), ‡∏≠‡πâ‡∏ß‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö 2 (‚â•30.0)</p>

      <form id="bmiForm" novalidate style="margin-top:12px">
        <div class="grid grid-4">
          <div>
            <label for="fullname">‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏£‡∏¥‡∏á</label>
            <input id="fullname" class="field" type="text" placeholder="‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•" required>
          </div>
          <div>
            <label for="nickname">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô</label>
            <input id="nickname" class="field" type="text" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô" required>
          </div>
          <div>
            <label for="weight">‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å (‡∏Å‡∏Å.)</label>
            <input id="weight" class="field" type="number" min="0.1" step="0.1" placeholder="‡πÄ‡∏ä‡πà‡∏ô 60.5" required>
          </div>
          <div>
            <label for="height">‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏π‡∏á (‡∏ã‡∏°.)</label>
            <input id="height" class="field" type="number" min="0.1" step="0.1" placeholder="‡πÄ‡∏ä‡πà‡∏ô 165.0" required>
          </div>
        </div>

        <div class="actions">
          <button type="submit" class="primary">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì & ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
          <button type="button" id="resetBtn" class="ghost">‡∏•‡πâ‡∏≤‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°</button>
          <button type="button" id="exportBtn" class="ghost">Export CSV</button>
          <button type="button" id="clearAllBtn" class="danger">‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
        </div>

        <div id="instant" class="instant"></div>
      </form>
    </section>

    <!-- ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡πÅ‡∏•‡πâ‡∏ß -->
    <section class="card">
      <h2>‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡πÅ‡∏•‡πâ‡∏ß</h2>
      <div class="table-wrap">
        <table id="table">
          <thead>
            <tr>
              <th>#</th>
              <th>‡πÄ‡∏ß‡∏•‡∏≤</th>
              <th>‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏£‡∏¥‡∏á</th>
              <th>‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô</th>
              <th>‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å (‡∏Å‡∏Å.)</th>
              <th>‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏π‡∏á (‡∏ã‡∏°.)</th>
              <th>BMI</th>
              <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
      <p class="lead" style="margin-top:8px">* ‡πÉ‡∏ä‡πâ ‚Äú‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏£‡∏¥‡∏á‚Äù ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•: ‡∏ñ‡πâ‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏î‡∏¥‡∏°‡∏Å‡∏£‡∏≠‡∏Å‡∏ã‡πâ‡∏≥ ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÅ‡∏ñ‡∏ß‡πÄ‡∏î‡∏¥‡∏°‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</p>
    </section>

    <!-- TAB 2: ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á -->
    <section id="statusTab" class="card" style="display:none">
      <h1>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</h1>
      <p class="lead">‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏ß‡πà‡∏≤‡πÉ‡∏Ñ‡∏£ ‚Äú‡∏™‡πà‡∏á‡πÅ‡∏•‡πâ‡∏ß/‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‚Äù (‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô)</p>
      <div class="table-wrap" style="margin-top:10px">
        <table id="rosterTable">
          <thead>
            <tr>
              <th>#</th>
              <th>‡∏ä‡∏∑‡πà‡∏≠</th>
              <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
              <th>‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</th>
              <th>‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô</th>
              <th>BMI</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
      <p class="lead" id="rosterSummary" style="margin-top:8px"></p>
    </section>
  </div>

  <script>
    const KEY = 'bmi_entries_v_noid';
    const $ = id => document.getElementById(id);

    // ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô (‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏´‡∏±‡∏™)
    const ROSTER = [
      "‡∏Å‡∏ô‡∏Å‡∏ô‡∏≤‡∏ñ ‡∏õ‡∏≤‡∏ó‡∏≤‡∏ô","‡∏ì‡∏±‡∏ê‡∏ô‡∏¥‡∏ä‡∏≤ ‡∏´‡∏¥‡πâ‡∏ô‡∏Æ‡∏±‡πâ‡∏ô","‡∏û‡∏£‡∏û‡∏£‡∏´‡∏° ‡∏Ç‡∏ß‡∏±‡∏ç‡πÄ‡∏°‡∏∑‡∏≠‡∏á","‡∏û‡∏£‡πÑ‡∏û‡∏£‡∏¥‡∏ô ‡∏™‡∏∏‡∏Å‡∏™‡∏±‡∏¢",
      "‡πÅ‡∏û‡∏£‡∏†‡∏±‡∏™ ‡∏û‡∏á‡∏©‡πå‡∏®‡∏¥‡∏£‡∏¥‡∏Å‡∏∏‡∏•","‡∏ä‡∏∑‡πà‡∏ô‡∏Å‡∏°‡∏• ‡∏ï‡∏£‡∏∞‡∏Å‡∏∏‡∏•‡∏ô‡∏¥‡∏ï‡∏¢‡πå","‡∏î‡∏•‡∏ç‡∏ò‡∏¥‡∏î‡∏≤ ‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏õ‡∏£‡∏∞‡∏î‡∏¥‡∏©‡∏ê",
      "‡∏û‡∏£‡∏ò‡∏¥‡∏î‡∏≤ ‡∏ô‡∏≤‡πÄ‡∏à‡∏£‡∏¥‡∏ç","‡πÇ‡∏ç‡∏Æ‡∏≤‡∏ô‡∏¥‡∏™ ‡∏à‡∏á‡∏£‡∏±‡∏Å‡∏©‡πå","‡∏ò‡∏±‡∏ô‡∏¢‡πå‡∏ä‡∏ô‡∏Å ‡∏û‡∏•‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå",
      "‡∏ô‡∏±‡∏™‡∏ã‡∏¥‡∏°‡∏≤ ‡∏Å‡∏¥‡∏à‡∏à‡∏≤‡∏£‡∏±‡∏Å‡∏©‡πå","‡∏õ‡∏ß‡∏µ‡∏ì‡πå‡∏Å‡∏£ ‡∏™‡∏≤‡∏¢‡∏ó‡∏≠‡∏á‡∏≠‡∏¥‡∏ô‡∏ó‡∏£‡πå","‡∏ü‡∏≤‡πÄ‡∏î‡∏µ‡∏¢‡∏Æ‡∏≤‡∏• ‡∏Ç‡∏∏‡∏ô‡∏≠‡∏¥‡∏ô‡∏Ñ‡∏µ‡∏£‡∏µ",
      "‡∏ã‡∏µ‡∏ô‡∏µ‡∏ô ‡∏≠‡∏ô‡∏∏‡∏Å‡∏π‡∏•","‡∏Ñ‡∏ë‡∏≤‡∏ó‡∏¥‡∏û‡∏¢‡πå ‡∏ä‡∏∏‡∏°‡πÄ‡∏õ‡∏µ‡∏¢","‡∏à‡∏¥‡∏£‡∏ß‡∏±‡∏í‡∏ì‡πå ‡∏õ‡∏è‡∏¥‡∏™‡∏∏‡∏ß‡∏£‡∏£‡∏ì‡πå",
      "‡∏ü‡∏¥‡∏ï‡∏£‡∏µ‡∏¢‡∏≤ ‡∏î‡πà‡∏≠‡∏•‡πä‡∏∞","‡∏°‡∏π‡∏Æ‡∏≥‡∏´‡∏°‡∏±‡∏î‡∏ö‡∏±‡∏¢‡∏Æ‡∏≤‡∏Å‡∏µ ‡∏™‡∏≤‡πÅ‡∏•‡∏∞","‡∏•‡∏±‡∏Ñ‡∏ô‡∏≤ ‡∏õ‡∏•‡∏≠‡∏î‡∏≠‡πà‡∏≠‡∏ô","‡∏®‡∏¥‡∏ß‡∏Å‡∏£ ‡∏£‡∏±‡∏Å‡∏©‡πå‡∏ß‡∏á‡∏®‡πå",
      "‡∏≠‡∏±‡∏ä‡∏£‡∏≠‡∏ô ‡πÄ‡∏´‡πá‡∏°‡πÄ‡∏≠‡∏µ‡∏¢‡∏î","‡∏ï‡∏±‡∏™‡∏ô‡∏µ‡∏° ‡∏î‡∏∑‡∏≠‡∏£‡∏≤‡πÅ‡∏°","‡∏ô‡∏±‡∏™‡∏£‡∏µ‡∏ô ‡πÄ‡∏à‡πä‡∏∞‡∏™‡∏±‡∏ô","‡∏Å‡∏±‡∏•‡∏¢‡∏≤‡∏£‡∏±‡∏ï‡∏ô‡πå ‡∏™‡∏≠‡∏ô‡∏™‡∏á‡∏Ñ‡∏£‡∏≤‡∏°",
      "‡∏ã‡∏¥‡∏•‡∏°‡∏µ‡πà‡∏¢‡πå ‡∏¢‡∏≠‡∏î‡πÅ‡∏Å‡πâ‡∏ß","‡∏ô‡∏π‡∏£‡∏∏‡∏•‡∏Æ‡∏π‡∏î‡∏≤ ‡πÅ‡∏ß‡πÇ‡∏ã‡∏∞","‡∏Å‡∏ä‡∏Å‡∏£ ‡πÅ‡∏Å‡πâ‡∏ß‡∏ô‡∏û‡∏Ñ‡∏∏‡∏ì","‡∏£‡∏¥‡∏î‡∏î‡πå‡∏ß‡∏±‡∏ô ‡πÅ‡∏°‡∏´‡∏∞",
      "‡∏ô‡∏∏‡∏™‡∏£‡∏µ‡∏ï‡πâ‡∏≤ ‡∏£‡∏±‡∏Å‡πÑ‡∏ó‡∏£","‡∏õ‡∏∏‡∏ç‡∏ç‡∏û‡∏±‡∏í‡∏ô‡πå ‡πÄ‡∏î‡∏ä‡∏â‡∏¥‡∏°","‡∏≠‡∏∏‡∏î‡∏°‡∏™‡∏¥‡∏£‡∏¥ ‡πÄ‡∏ó‡∏û‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå","‡∏Ç‡∏ß‡∏±‡∏ç‡∏°‡∏ô‡∏±‡∏™ ‡∏ä‡∏π‡∏ö‡∏±‡∏ß‡πÅ‡∏Å‡πâ‡∏ß",
      "‡∏î‡∏ß‡∏á‡∏Å‡∏°‡∏• ‡∏£‡∏≤‡∏ä‡∏Ñ‡∏£‡∏≠‡∏á‡πÄ‡∏°‡∏∑‡∏≠‡∏á","‡∏ï‡∏±‡∏™‡∏ô‡∏¥‡∏ô ‡∏™‡∏≤‡∏°‡∏≤‡∏°‡∏∞","‡∏ô‡∏±‡∏ô‡∏ó‡∏¥‡∏Å‡∏≤‡∏ô‡∏ï‡πå ‡∏´‡∏°‡∏≤‡∏î‡∏´‡∏ô‡∏∏‡∏î","‡∏ô‡∏¥‡∏®‡∏±‡∏•‡∏°‡∏µ ‡∏õ‡∏π‡πÄ‡∏ï‡πä‡∏∞",
      "‡∏õ‡∏±‡∏ì‡∏ì‡∏ò‡∏£ ‡∏Ñ‡∏∏‡πâ‡∏°‡∏£‡∏±‡∏Å‡∏©‡πå","‡∏û‡∏¥‡∏ä‡∏ç‡∏≤ ‡∏°‡∏π‡∏´‡∏∞‡∏´‡∏°‡∏±‡∏î","‡∏ß‡∏£‡∏£‡∏ì‡∏©‡∏≤ ‡πÑ‡∏ä‡∏¢‡πÇ‡∏Ñ‡∏ï‡∏£‡πå","‡∏™‡∏¥‡∏£‡∏¥‡∏£‡∏±‡∏ï‡∏ô‡πå ‡∏õ‡∏∏‡∏ô‡∏ó‡∏∞‡∏°‡∏∏‡∏ì‡∏µ",
      "‡πÄ‡∏™‡∏≤‡∏ß‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå ‡πÄ‡∏ß‡∏ä‡∏¢‡∏°","‡∏≠‡∏ò‡∏¥‡∏ä‡∏≤ ‡∏†‡∏≤‡∏ì‡∏∏‡∏ß‡∏±‡∏í‡∏ô‡πå‡∏†‡∏¥‡∏ç‡πÇ‡∏ç","‡∏Æ‡∏±‡∏ô‡∏ô‡∏≤‡∏£‡πå ‡∏´‡∏¢‡∏µ‡πÄ‡∏´‡∏¢‡∏á","‡πÄ‡∏™‡∏é‡∏ê‡∏ß‡∏∏‡∏í‡∏¥ ‡∏à‡∏¥‡∏ï‡∏£‡∏ß‡∏¥‡∏£‡∏±‡∏ï‡∏ô‡πå"
    ];

    const load = () => JSON.parse(localStorage.getItem(KEY) || '[]');
    const save = rows => localStorage.setItem(KEY, JSON.stringify(rows));
    const esc = s => String(s).replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#039;'}[m]));

    // ‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡πÄ‡∏≠‡πÄ‡∏ä‡∏µ‡∏¢/‡πÑ‡∏ó‡∏¢
    function classify(bmi){
      if (bmi < 18.5) return {label:'‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏Å‡∏ì‡∏ë‡πå', cls:'low'};
      if (bmi < 23.0) return {label:'‡∏õ‡∏Å‡∏ï‡∏¥', cls:'ok'};
      if (bmi < 25.0) return {label:'‡∏ó‡πâ‡∏ß‡∏°', cls:'over'};
      if (bmi < 30.0) return {label:'‡∏≠‡πâ‡∏ß‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö 1', cls:'ob1'};
      return {label:'‡∏≠‡πâ‡∏ß‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö 2', cls:'ob2'};
    }

    // Tabs
    document.querySelectorAll('.tabbtn').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        document.querySelectorAll('.tabbtn').forEach(b=>b.classList.remove('active'));
        btn.addEventListener; btn.classList.add('active');
        const tgt = btn.dataset.tab;
        ['formTab','statusTab'].forEach(id => $(id).style.display = (id===tgt?'block':'none'));
        if (tgt==='statusTab') renderRoster();
      });
    });

    // Form submit
    $('bmiForm').addEventListener('submit', e=>{
      e.preventDefault();
      const fullname = $('fullname').value.trim();
      const nickname = $('nickname').value.trim();
      const w = parseFloat($('weight').value);
      const hcm = parseFloat($('height').value);
      if (!fullname || !nickname || !(w>0) || !(hcm>0)) return;

      const h = hcm/100;
      const bmi = w/(h*h);
      const cat = classify(bmi);
      $('instant').innerHTML = `‡∏Ñ‡πà‡∏≤ BMI ‡∏Ç‡∏≠‡∏á <b>${esc(fullname)}</b> (${esc(nickname)}) = <b>${bmi.toFixed(2)}</b> ‚Äî <span class="status ${cat.cls}">${cat.label}</span>`;

      const rows = load();
      const idx = rows.findIndex(r => r.fullname.trim() === fullname);
      const rec = { ts: Date.now(), fullname, nickname, weight: w, height: hcm, bmi };
      if (idx >= 0) rows[idx] = rec; else rows.push(rec);
      save(rows);
      renderSubmitted();
      renderRoster();
      e.target.reset();
      $('fullname').focus();
    });

    $('resetBtn').addEventListener('click', ()=>{
      $('bmiForm').reset();
      $('instant').innerHTML = '';
      $('fullname').focus();
    });

    $('clearAllBtn').addEventListener('click', ()=>{
      if (!confirm('‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î?')) return;
      localStorage.removeItem(KEY);
      renderSubmitted();
      renderRoster();
      $('instant').innerHTML = '';
    });

    $('exportBtn').addEventListener('click', ()=>{
      const rows = load();
      const header = ['timestamp_iso','fullname','nickname','weight_kg','height_cm','bmi','category'];
      const lines = [header.join(',')];
      rows.forEach(r=>{
        const cat = classify(r.bmi).label;
        lines.push([
          new Date(r.ts).toISOString(),
          csvSafe(r.fullname),
          csvSafe(r.nickname),
          r.weight.toFixed(1),
          r.height.toFixed(1),
          r.bmi.toFixed(2),
          csvSafe(cat)
        ].join(','));
      });
      const blob = new Blob([lines.join('\n')], {type:'text/csv;charset=utf-8;'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url; a.download = 'bmi_export.csv';
      document.body.appendChild(a); a.click();
      URL.revokeObjectURL(url); a.remove();
    });
    const csvSafe = s => `"${String(s).replace(/"/g,'""')}"`;

    // Render tables
    function renderSubmitted(){
      const tb = document.querySelector('#table tbody');
      const rows = load().slice().sort((a,b)=>a.fullname.localeCompare(b.fullname,'th'));
      tb.innerHTML = '';
      rows.forEach((r,i)=>{
        const c = classify(r.bmi);
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${i+1}</td>
          <td>${new Date(r.ts).toLocaleString()}</td>
          <td>${esc(r.fullname)}</td>
          <td>${esc(r.nickname)}</td>
          <td>${r.weight.toFixed(1)}</td>
          <td>${r.height.toFixed(1)}</td>
          <td>${r.bmi.toFixed(2)}</td>
          <td><span class="status ${c.cls}">${c.label}</span></td>
        `;
        tb.appendChild(tr);
      });
    }

    function renderRoster(){
      const map = new Map(load().map(r => [r.fullname.trim(), r]));
      const tb = document.querySelector('#rosterTable tbody');
      tb.innerHTML = '';
      let done = 0;
      ROSTER.forEach((name, i)=>{
        const rec = map.get(name);
        const sent = !!rec;
        if (sent) done++;
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${i+1}</td>
          <td>${esc(name)}</td>
          <td>${sent ? '<span class="tag oktag">‡∏™‡πà‡∏á‡πÅ‡∏•‡πâ‡∏ß</span>' : '<span class="tag waittag">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á</span>'}</td>
          <td>${sent ? esc(new Date(rec.ts).toLocaleString()) : '‚Äî'}</td>
          <td>${sent ? esc(rec.nickname) : '‚Äî'}</td>
          <td>${sent ? rec.bmi.toFixed(2) : '‚Äî'}</td>
        `;
        tb.appendChild(tr);
      });
      $('rosterSummary').textContent = `‡∏™‡πà‡∏á‡πÅ‡∏•‡πâ‡∏ß ${done} ‡∏Ñ‡∏ô ‚Ä¢ ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á ${ROSTER.length - done} ‡∏Ñ‡∏ô ‚Ä¢ ‡∏£‡∏ß‡∏° ${ROSTER.length} ‡∏Ñ‡∏ô`;
    }

    // Init
    renderSubmitted();
    renderRoster();
  </script>
</body>
</html>
